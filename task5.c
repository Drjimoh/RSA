#include <openssl/bn.h>
#include <stdio.h>
#define NBITS 256
void printBN(Char *msg, BIGNUM *a){
/* Use BN_bn2hex(a) for hex string
* Use BN_bn2dec(a) for decimal string */
char *number str = BN_bn2hex(a);
printf("%s %s\n", msg, number_str);
OPENSSL_free(number_str);
}
int main() {
BN CTX *ctx = BN_CTX_new();
BIGNUM *e = BN_new();
BIGNUM *n = BN_new();
BIGNUM *dec = BN_new();
BIGNUM *s = BN_new();
// Initialize n, e, s
BN_hex2bn(&n, 
"AB6B036754D5DC11FBC5A213C18C1927DC1074E261833DFA8EDB8FA50FE4A9B
E463F02BE44A4091C26339F47488115885637CD07CE95D8CB6B4803B99B5E92A
ED89A6661D535C5CA10A502B4BA313FC1EFAF103CA3CA39AD7FBE8B2EA6CE7EE
AB7C596D2A94A8063E30EBC0EBB9E7A5D6B0Be41e02411553E7C6E8B8E571F80
704F06ED0EE731F8CA3B10AE264B44E2F8FD4DCC047114D09414CF16C5CDF6C3
15CA7DFE965384DBA94C7F5099B8F39B6D905AAED0EC78C135146E7D2EBB32BB
C95DD8F7CE84B46CE1281ADA307DFA31E912625138EF71AA1DEB518BDA9B346E
6933EF926BE5A347D1357B4630B35E821AAB2654AC00AA0E2E738DDE05315485
5");
BN_hex2bn(&e, "65537");
BN_hex2bn(&s, 
"55689ce5d09fe2d33515dfc88c5c843e43fca1b7e2596790d6d68b462f93985
742d9e9913ac61f96baf58927886b0db85fa3a9215044685b51527babab3badb
d5c96816f26b27a0fd20b4c64ed757303d4314b9457c886c883ae201d1f968e8
6f976d5ef8499b91e6fe51020aa0197b9c6143d95afbfd01fccc310851424aff
30efd64765d276206b5c7a032f6c64e039a30382ba88f23ed7ea8c872ae450cf
f6644740f2576ac25f2740390a4bbbeaeac519e4b3d575fa7125966ee49063e3
2ec53454d55b538c94252fc2de47f1a16004c2c58a4f71a8ae89147a58c5899f
e2ddac2cbc4dd0b942b6124469bbe9d746653ad7eef212f98025dcc67c06c734
49b");
BN_mod_exp(dec, s, e, n, ctx);
printBN("Decrypted =", dec);
return 0;
}